"use strict";!function(a){function b(a){var b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return b[c]}function c(a,b){return a.replace(/\d+/g,function(a){return""+Math.round(parseInt(a)*b)})}function d(){var a={},b=null,c={style:"fill",direction:"horizontal",randomProgress:!0};this.profile=function(c,d){if(1==arguments.length){if(b)throw Error("Default profile already set.");b=c}else{if(a[c])throw Error("Profile ["+c+"] aready set.");a[c]=d}},this.$get=function(){return{getProfile:function(d){return d&&a[d]?a[d]:b||c}}}}function e(d,e,f){return{restrict:"A",transclude:!0,scope:{progressButton:"&",pbStyle:"@",pbDirection:"@",pbProfile:"@"},template:'<span class="content" ng-transclude></span><span class="progress-button-progress" ng-style="progressStyles"><span class="progress-inner" ng-style="progressInnerStyles" ng-class="{ notransition: !allowProgressTransition }"></span></span>',controller:function(){},link:function(g,h,i){function j(){var a=e.getProfile(g.pbProfile);g.pbStyle=g.pbStyle||a.style||"fill",g.pbDirection="lateral-lines"!=g.pbStyle?g.pbDirection||a.direction||"horizontal":"vertical",g.pbPerspective=0==g.pbStyle.indexOf("rotate")||0==g.pbStyle.indexOf("flip-open"),g.pbRandomProgress=i.pbRandomProgress?"false"!==i.pbRandomProgress:a.randomProgress||!0}function k(a){g.progressInnerStyles[p]=100*a+"%"}function l(){h.removeAttr("disabled")}function m(){var a=0;return f(function(){a+=(1-a)*Math.random()*.5,k(a)},200)}function n(a){function b(a){"opacity"===a.propertyName&&(h.off(o,b),g.$apply(function(){g.allowProgressTransition=!1,k(0),g.progressInnerStyles.opacity=1}))}if(o&&(g.progressInnerStyles.opacity=0,h.on(o,b)),"number"==typeof a){var c=a>=0?"state-success":"state-error";h.addClass(c),setTimeout(function(){h.removeClass(c),l()},1500)}else l();h.removeClass("state-loading")}j();var o=b(h[0]),p="vertical"==g.pbDirection?"height":"width",q=h.hasClass("btn");g.progressInnerStyles={},g.progressStyles={},g.allowProgressTransition=!1,h.addClass("progress-button"),q||h.addClass("progress-button-defaults");var r=getComputedStyle(h[0]),s=r.getPropertyValue("background-color");if(g.progressStyles["background-color"]=c(s,.925),q&&(g.progressInnerStyles["background-color"]=c(s,.85)),g.pbPerspective){var t=a.element('<span class="progress-wrap"></span>');t.append(h.children()),h.append(t),h.addClass("progress-button-perspective")}h.addClass("progress-button-dir-"+g.pbDirection),h.addClass("progress-button-style-"+g.pbStyle),h.on("click",function(){g.$apply(function(){g.allowProgressTransition=!0,h.addClass("state-loading").attr("disabled","disabled");var a=null;d.when(g.progressButton()).then(function(){k(1),a&&f.cancel(a),n(1)},function(){a&&f.cancel(a),n(-1)},function(a){!g.pbRandomProgress&&k(a)}),g.pbRandomProgress&&(a=m())})})}}}var f=a.module("angular-progress-button-styles",[]);f.provider("progressButtonConfig",d),f.directive("progressButton",e),e.$inject=["$q","progressButtonConfig","$interval"]}(angular);